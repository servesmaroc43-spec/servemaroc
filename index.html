<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SERVE MAROC | تسجيل الدخول</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Tajawal', sans-serif; 
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }
        
        /* تصميم الخلفية المتحركة */
        .bg-pattern {
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(37, 99, 235, 0.08) 0%, transparent 20%),
                radial-gradient(circle at 80% 20%, rgba(124, 58, 237, 0.08) 0%, transparent 20%),
                radial-gradient(circle at 40% 40%, rgba(37, 99, 235, 0.05) 0%, transparent 20%);
            z-index: -1;
        }
        
        .main-card { 
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 28px; 
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.1),
                0 0 0 1px rgba(255, 255, 255, 0.8),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            width: 100%; 
            max-width: 500px; 
            padding: 45px 35px; 
            position: relative;
            overflow: hidden;
        }
        
        .main-card:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 25px 70px rgba(0, 0, 0, 0.15),
                0 0 0 1px rgba(255, 255, 255, 0.9),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }
        
        /* التأثير الجانبي الملون */
        .card-side-accent {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            width: 6px;
            background: linear-gradient(to bottom, #2563eb, #7c3aed);
            border-radius: 0 28px 28px 0;
        }
        
        /* تحسين الشعار */
        .logo-container {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .logo-text { 
            font-size: 36px; 
            font-weight: 800; 
            letter-spacing: -1.5px; 
            position: relative;
            display: inline-block;
            padding-bottom: 15px;
        }
        
        .logo-text span:first-child { 
            color: #2563eb; 
            text-shadow: 0 2px 4px rgba(37, 99, 235, 0.2);
        }
        
        .logo-text span:last-child { 
            color: #7c3aed;
            text-shadow: 0 2px 4px rgba(124, 58, 237, 0.2);
        }
        
        .logo-text::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 25%;
            width: 50%;
            height: 4px;
            background: linear-gradient(to left, #2563eb, #7c3aed);
            border-radius: 2px;
        }
        
        /* تحسين التبويبات */
        .tabs { 
            display: flex; 
            background: #f1f5f9; 
            border-radius: 16px; 
            padding: 6px; 
            margin-bottom: 35px; 
            position: relative; 
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .tab { 
            flex: 1; 
            text-align: center; 
            padding: 14px 5px; 
            cursor: pointer; 
            font-weight: 700; 
            color: #64748b; 
            border-radius: 12px; 
            transition: all 0.3s; 
            z-index: 2;
            position: relative;
            font-size: 16px;
        }
        
        .tab.active { 
            color: #2563eb; 
        }
        
        .tab-slider { 
            position: absolute; 
            top: 6px; 
            bottom: 6px; 
            right: 6px; 
            width: calc(50% - 6px); 
            background: white; 
            border-radius: 12px; 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); 
            transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); 
            z-index: 1; 
        }
        
        .slider-login { transform: translateX(-100%); }
        
        /* تحسين حقول الإدخال - التصحيح */
        .input-group { 
            margin-bottom: 24px; 
            position: relative; 
            /* تم إزالة text-align: center */
        }
        
        .input-group label { 
            display: block; 
            margin-bottom: 10px; 
            color: #475569; 
            font-size: 16px; 
            font-weight: 700; 
            transition: color 0.3s;
            text-align: center; /* توسيط النص فقط للـ label */
            width: 100%;
        }
        
        .input-container {
            position: relative;
            width: 100%;
        }
        
        .input-group input { 
            width: 100%; 
            padding: 17px 20px 17px 45px; 
            border: 2px solid #e2e8f0; 
            border-radius: 14px; 
            font-size: 16px; 
            text-align: right; /* النص على اليمين */
            background: #f8fafc; 
            transition: all 0.3s;
            font-family: 'Tajawal', sans-serif;
            direction: rtl;
        }
        
        .input-group input::placeholder {
            text-align: right;
            color: #94a3b8;
        }
        
        .input-group input:focus { 
            outline: none; 
            border-color: #2563eb; 
            background: white; 
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.15); 
        }
        
        .input-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #94a3b8;
            font-size: 18px;
            transition: all 0.3s;
            z-index: 2;
        }
        
        /* زر إظهار/إخفاء كلمة المرور */
        .password-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #94a3b8;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 3;
        }
        
        .password-toggle:hover {
            color: #2563eb;
        }
        
        /* رابط نسيت كلمة المرور */
        .forgot-password {
            text-align: left;
            margin-top: -10px;
            margin-bottom: 20px;
        }
        
        .forgot-link {
            color: #2563eb;
            text-decoration: none;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .forgot-link:hover {
            color: #1d4ed8;
            text-decoration: underline;
        }
        
        /* تحسين الأزرار */
        .btn { 
            width: 100%; 
            padding: 18px; 
            background: linear-gradient(to left, #2563eb, #4f46e5); 
            color: white; 
            border: none; 
            border-radius: 14px; 
            font-weight: 800; 
            cursor: pointer; 
            transition: all 0.3s; 
            margin-top: 10px; 
            font-size: 18px; 
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 0;
            height: 100%;
            background: linear-gradient(to left, #1d4ed8, #4338ca);
            transition: width 0.4s ease;
            z-index: -1;
        }
        
        .btn:hover::before {
            width: 100%;
        }
        
        .btn:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 8px 20px rgba(37, 99, 235, 0.3); 
        }
        
        .btn:active { transform: translateY(0); }
        
        .btn:disabled { 
            background: linear-gradient(to left, #94a3b8, #94a3b8); 
            cursor: not-allowed; 
            transform: none; 
            box-shadow: none;
        }
        
        /* تصميم OTP */
        .otp-container {
            margin: 25px 0;
            text-align: center;
        }
        
        .otp-title {
            font-size: 22px;
            font-weight: 800;
            color: #1e293b;
            margin-bottom: 10px;
        }
        
        .otp-subtitle {
            color: #64748b;
            font-size: 15px;
            margin-bottom: 5px;
        }
        
        .user-email {
            color: #2563eb;
            font-weight: 700;
            background: #f1f5f9;
            padding: 6px 12px;
            border-radius: 8px;
            display: inline-block;
            margin: 10px 0;
        }
        
        .otp-inputs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 25px 0;
        }
        
        .otp-input {
            width: 50px;
            height: 60px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 24px;
            font-weight: 700;
            text-align: center;
            background: #f8fafc;
            transition: all 0.3s;
        }
        
        .otp-input:focus {
            outline: none;
            border-color: #2563eb;
            background: white;
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.15);
        }
        
        .otp-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        /* الروابط */
        .back-link {
            color: #2563eb;
            text-decoration: none;
            font-weight: 700;
            font-size: 15px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-top: 20px;
            transition: all 0.3s;
        }
        
        .back-link:hover {
            color: #1d4ed8;
        }
        
        .hidden { display: none !important; }
        
        /* التحميل */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* متجاوب */
        @media (max-width: 500px) {
            .main-card {
                padding: 35px 25px;
                max-width: 95%;
            }
            
            .logo-text {
                font-size: 32px;
            }
            
            .btn {
                padding: 16px;
            }
            
            .input-group input {
                padding: 15px 15px 15px 40px;
                font-size: 15px;
            }
            
            .input-icon {
                left: 12px;
                font-size: 16px;
            }
            
            .otp-input {
                width: 45px;
                height: 55px;
                font-size: 22px;
            }
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    
    <div class="main-card">
        <div class="card-side-accent"></div>
        
        <div class="logo-container">
            <div class="logo-text"><span>SERVE</span><span>MAROC</span></div>
        </div>
        
        <!-- التبويبات -->
        <div class="tabs" id="auth-tabs">
            <div id="tab-register" class="tab active" onclick="switchTab('register')">حساب جديد</div>
            <div id="tab-login" class="tab" onclick="switchTab('login')">تسجيل الدخول</div>
            <div id="tab-slider" class="tab-slider"></div>
        </div>
        
        <!-- قسم التسجيل -->
        <div id="section-register" class="form-section">
            <div class="input-group">
                <label for="reg-name">الاسم الكامل</label>
                <div class="input-container">
                    <input type="text" id="reg-name" placeholder="أدخل اسمك الكامل">
                    <div class="input-icon"><i class="fas fa-user"></i></div>
                </div>
            </div>
            
            <div class="input-group">
                <label for="reg-email">البريد الإلكتروني</label>
                <div class="input-container">
                    <input type="email" id="reg-email" placeholder="example@email.com">
                    <div class="input-icon"><i class="fas fa-envelope"></i></div>
                </div>
            </div>
            
            <div class="input-group">
                <label for="reg-pass">كلمة المرور</label>
                <div class="input-container">
                    <input type="password" id="reg-pass" placeholder="6 أحرف على الأقل">
                    <div class="input-icon"><i class="fas fa-lock"></i></div>
                    <div class="password-toggle" onclick="togglePassword('reg-pass', this)">
                        <i class="fas fa-eye"></i>
                    </div>
                </div>
            </div>
            
            <button class="btn" id="reg-btn" onclick="handleRegister()">
                إنشاء حساب <i class="fas fa-user-plus"></i>
            </button>
        </div>
        
        <!-- قسم تسجيل الدخول -->
        <div id="section-login" class="form-section hidden">
            <div class="input-group">
                <label for="login-email">البريد الإلكتروني</label>
                <div class="input-container">
                    <input type="email" id="login-email" placeholder="أدخل بريدك الإلكتروني">
                    <div class="input-icon"><i class="fas fa-envelope"></i></div>
                </div>
            </div>
            
            <div class="input-group">
                <label for="login-pass">كلمة المرور</label>
                <div class="input-container">
                    <input type="password" id="login-pass" placeholder="أدخل كلمة المرور">
                    <div class="input-icon"><i class="fas fa-lock"></i></div>
                    <div class="password-toggle" onclick="togglePassword('login-pass', this)">
                        <i class="fas fa-eye"></i>
                    </div>
                </div>
            </div>
            
            <div class="forgot-password">
                <a href="#" class="forgot-link" onclick="showForgotPassword()">
                    <i class="fas fa-key"></i> نسيت كلمة المرور؟
                </a>
            </div>
            
            <button class="btn" onclick="handleLogin()">
                تسجيل الدخول <i class="fas fa-sign-in-alt"></i>
            </button>
        </div>
        
        <!-- قسم نسيت كلمة المرور -->
        <div id="section-forgot" class="form-section hidden">
            <div class="otp-container">
                <h3 class="otp-title">استعادة كلمة المرور</h3>
                <p class="otp-subtitle">أدخل بريدك الإلكتروني وسنرسل لك رمز التحقق</p>
                
                <div class="input-group">
                    <label for="forgot-email">البريد الإلكتروني</label>
                    <div class="input-container">
                        <input type="email" id="forgot-email" placeholder="أدخل بريدك الإلكتروني">
                        <div class="input-icon"><i class="fas fa-envelope"></i></div>
                    </div>
                </div>
                
                <button class="btn" onclick="sendOTP()">
                    إرسال رمز التحقق <i class="fas fa-paper-plane"></i>
                </button>
                
                <a href="#" class="back-link" onclick="backToLogin()">
                    <i class="fas fa-arrow-right"></i> العودة لتسجيل الدخول
                </a>
            </div>
        </div>
        
        <!-- قسم التحقق بالرمز OTP -->
        <div id="section-otp" class="form-section hidden">
            <div class="otp-container">
                <h3 class="otp-title">التحقق بالرمز</h3>
                <p class="otp-subtitle">أدخل الرمز المكون من 6 أرقام المرسل إلى</p>
                <div class="user-email" id="otp-email">user@example.com</div>
                
                <div class="otp-inputs" id="otp-inputs">
                    <input type="text" class="otp-input" maxlength="1" oninput="moveToNext(this, 1)">
                    <input type="text" class="otp-input" maxlength="1" oninput="moveToNext(this, 2)">
                    <input type="text" class="otp-input" maxlength="1" oninput="moveToNext(this, 3)">
                    <input type="text" class="otp-input" maxlength="1" oninput="moveToNext(this, 4)">
                    <input type="text" class="otp-input" maxlength="1" oninput="moveToNext(this, 5)">
                    <input type="text" class="otp-input" maxlength="1" oninput="moveToNext(this, 6)">
                </div>
                
                <div class="otp-actions">
                    <button class="btn" onclick="verifyOTP()" id="verify-otp-btn">
                        التحقق <i class="fas fa-check"></i>
                    </button>
                    
                    <button class="btn" onclick="resendOTP()" id="resend-otp-btn" style="background: #64748b;">
                        إعادة الإرسال <i class="fas fa-redo"></i>
                    </button>
                </div>
                
                <a href="#" class="back-link" onclick="backToForgot()">
                    <i class="fas fa-arrow-right"></i> العودة
                </a>
            </div>
        </div>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxZI5mXF5JclUBT3YcvtFH_47932oe_qrxmVwMeUI3M6Rv0Wo0LgvCHRcJ9oujZOToT1A/exec';
        let currentOTP = '';
        let otpEmail = '';

        // تبديل التبويبات
        function switchTab(tabName) {
            const slider = document.getElementById('tab-slider');
            const regSect = document.getElementById('section-register');
            const logSect = document.getElementById('section-login');
            const regTab = document.getElementById('tab-register');
            const logTab = document.getElementById('tab-login');

            if (tabName === 'register') {
                slider.classList.remove('slider-login');
                regSect.classList.remove('hidden');
                logSect.classList.add('hidden');
                document.getElementById('section-forgot').classList.add('hidden');
                document.getElementById('section-otp').classList.add('hidden');
                regTab.classList.add('active');
                logTab.classList.remove('active');
            } else {
                slider.classList.add('slider-login');
                regSect.classList.add('hidden');
                logSect.classList.remove('hidden');
                document.getElementById('section-forgot').classList.add('hidden');
                document.getElementById('section-otp').classList.add('hidden');
                logTab.classList.add('active');
                regTab.classList.remove('active');
            }
        }

        // إظهار نسيت كلمة المرور
        function showForgotPassword() {
            document.getElementById('section-login').classList.add('hidden');
            document.getElementById('section-forgot').classList.remove('hidden');
            document.getElementById('tab-slider').style.display = 'none';
            
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
        }

        // العودة لتسجيل الدخول
        function backToLogin() {
            document.getElementById('section-forgot').classList.add('hidden');
            document.getElementById('section-login').classList.remove('hidden');
            document.getElementById('tab-slider').style.display = 'block';
            document.getElementById('tab-login').classList.add('active');
        }

        // العودة لنسيت كلمة المرور
        function backToForgot() {
            document.getElementById('section-otp').classList.add('hidden');
            document.getElementById('section-forgot').classList.remove('hidden');
        }

        // إظهار/إخفاء كلمة المرور
        function togglePassword(fieldId, toggleElement) {
            const passwordField = document.getElementById(fieldId);
            const icon = toggleElement.querySelector('i');
            
            if (passwordField.type === 'password') {
                passwordField.type = 'text';
                icon.className = 'fas fa-eye-slash';
            } else {
                passwordField.type = 'password';
                icon.className = 'fas fa-eye';
            }
        }

        // التسجيل
        async function handleRegister() {
            const name = document.getElementById('reg-name').value.trim();
            const email = document.getElementById('reg-email').value.trim();
            const pass = document.getElementById('reg-pass').value.trim();
            const btn = document.getElementById('reg-btn');
            
            if(!name || !email || !pass) {
                Swal.fire({
                    icon: 'info',
                    title: 'عذراً..',
                    text: 'المرجو ملء جميع الخانات للمتابعة',
                    confirmButtonText: 'حسناً',
                    confirmButtonColor: '#2563eb'
                });
                return;
            }
            
            if(pass.length < 6) {
                Swal.fire({
                    icon: 'warning',
                    title: 'كلمة مرور ضعيفة',
                    text: 'كلمة المرور يجب أن تكون 6 أحرف على الأقل',
                    confirmButtonText: 'حسناً',
                    confirmButtonColor: '#f59e0b'
                });
                return;
            }
            
            if(!validateEmail(email)) {
                Swal.fire({
                    icon: 'warning',
                    title: 'بريد إلكتروني غير صالح',
                    text: 'المرجو إدخال بريد إلكتروني صالح',
                    confirmButtonText: 'حسناً',
                    confirmButtonColor: '#f59e0b'
                });
                return;
            }
            
            btn.disabled = true;
            btn.innerHTML = 'جاري المعالجة... <span class="spinner"></span>';

            try {
                await fetch(scriptURL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify({ name, email, password: pass })
                });
                
                Swal.fire({
                    icon: 'success',
                    title: 'تم بنجاح!',
                    text: 'تم إنشاء حسابك وحفظ بياناتك في الجدول بنجاح.',
                    showConfirmButton: false,
                    timer: 2500
                });

                document.getElementById('reg-name').value = '';
                document.getElementById('reg-email').value = '';
                document.getElementById('reg-pass').value = '';
                
            } catch (error) {
                Swal.fire({
                    icon: 'error',
                    title: 'خطأ!',
                    text: 'حدث مشكل في الاتصال، حاول مرة أخرى.',
                    confirmButtonColor: '#ef4444'
                });
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'إنشاء حساب <i class="fas fa-user-plus"></i>';
            }
        }

        // تسجيل الدخول
        function handleLogin() {
            const email = document.getElementById('login-email').value.trim();
            const pass = document.getElementById('login-pass').value.trim();
            
            if(!email || !pass) {
                Swal.fire({
                    icon: 'info',
                    title: 'عذراً..',
                    text: 'المرجو إدخال البريد الإلكتروني وكلمة المرور',
                    confirmButtonText: 'حسناً',
                    confirmButtonColor: '#2563eb'
                });
                return;
            }
            
            Swal.fire({
                icon: 'success',
                title: 'تم الدخول بنجاح',
                text: 'مرحباً بعودتك إلى SERVE MAROC!',
                confirmButtonText: 'حسناً',
                confirmButtonColor: '#10b981'
            });
            
            document.getElementById('login-email').value = '';
            document.getElementById('login-pass').value = '';
        }

        // إرسال رمز OTP
        function sendOTP() {
            const email = document.getElementById('forgot-email').value.trim();
            
            if(!email || !validateEmail(email)) {
                Swal.fire({
                    icon: 'warning',
                    title: 'بريد إلكتروني غير صالح',
                    text: 'المرجو إدخال بريد إلكتروني صالح',
                    confirmButtonText: 'حسناً',
                    confirmButtonColor: '#f59e0b'
                });
                return;
            }
            
            // إنشاء رمز OTP عشوائي
            currentOTP = Math.floor(100000 + Math.random() * 900000).toString();
            otpEmail = email;
            
            // عرض رمز OTP (لأغراض الاختبار)
            Swal.fire({
                icon: 'info',
                title: 'تم إرسال الرمز',
                html: `تم إرسال رمز التحقق إلى: <strong>${email}</strong><br><br>
                      <small>لأغراض الاختبار، الرمز هو: <strong>${currentOTP}</strong></small>`,
                confirmButtonText: 'تم',
                confirmButtonColor: '#2563eb'
            });
            
            // الانتقال لصفحة OTP
            document.getElementById('section-forgot').classList.add('hidden');
            document.getElementById('section-otp').classList.remove('hidden');
            document.getElementById('otp-email').textContent = email;
            
            // تفريغ حقول OTP
            const otpInputs = document.querySelectorAll('.otp-input');
            otpInputs.forEach(input => input.value = '');
            otpInputs[0].focus();
        }

        // حركة بين حقول OTP
        function moveToNext(input, nextIndex) {
            const value = input.value;
            
            // السماح بالأرقام فقط
            if (!/^\d*$/.test(value)) {
                input.value = '';
                return;
            }
            
            if (value.length === 1 && nextIndex <= 6) {
                if (nextIndex < 6) {
                    const nextInput = document.querySelectorAll('.otp-input')[nextIndex];
                    nextInput.focus();
                }
            }
        }

        // التحقق من OTP
        function verifyOTP() {
            const otpInputs = document.querySelectorAll('.otp-input');
            let enteredOTP = '';
            
            otpInputs.forEach(input => {
                enteredOTP += input.value;
            });
            
            if (enteredOTP.length !== 6) {
                Swal.fire({
                    icon: 'warning',
                    title: 'رمز غير مكتمل',
                    text: 'الرجاء إدخال جميع الأرقام الستة',
                    confirmButtonText: 'حسناً',
                    confirmButtonColor: '#f59e0b'
                });
                return;
            }
            
            if (enteredOTP === currentOTP) {
                Swal.fire({
                    icon: 'success',
                    title: 'تم التحقق بنجاح!',
                    html: 'جاري توجيهك إلى Google Chat...',
                    showConfirmButton: false,
                    timer: 2000
                });
                
                setTimeout(() => {
                    window.location.href = 'https://chat.google.com/';
                }, 2000);
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'رمز غير صحيح',
                    text: 'الرمز الذي أدخلته غير صحيح. حاول مرة أخرى.',
                    confirmButtonText: 'حسناً',
                    confirmButtonColor: '#ef4444'
                });
            }
        }

        // إعادة إرسال OTP
        function resendOTP() {
            if (!otpEmail) return;
            
            // إنشاء رمز OTP جديد
            currentOTP = Math.floor(100000 + Math.random() * 900000).toString();
            
            Swal.fire({
                icon: 'info',
                title: 'تم إعادة الإرسال',
                html: `تم إرسال رمج جديد إلى: <strong>${otpEmail}</strong><br><br>
                      <small>لأغراض الاختبار، الرمز الجديد هو: <strong>${currentOTP}</strong></small>`,
                confirmButtonText: 'تم',
                confirmButtonColor: '#2563eb'
            });
            
            // تفريغ حقول OTP
            const otpInputs = document.querySelectorAll('.otp-input');
            otpInputs.forEach(input => input.value = '');
            otpInputs[0].focus();
        }

        // التحقق من صحة البريد الإلكتروني
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        // تهيئة الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            // إضافة حدث paste لحقول OTP
            const otpInputs = document.querySelectorAll('.otp-input');
            otpInputs.forEach(input => {
                input.addEventListener('paste', (e) => {
                    e.preventDefault();
                    const pastedData = e.clipboardData.getData('text').trim();
                    
                    if (/^\d{6}$/.test(pastedData)) {
                        for (let i = 0; i < 6; i++) {
                            otpInputs[i].value = pastedData[i];
                        }
                        otpInputs[5].focus();
                    }
                });
            });
        });
    </script>
</body>
</html>
